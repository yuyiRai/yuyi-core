"use strict";function e(e){return e&&"object"==typeof e&&"default"in e?e.default:e}var t=e(require("fs-extra")),r=require("gulp"),n=require("@yuyi919/utils"),i=require("@yuyi919/gulp-awesome"),a=require("path"),o=e(a);require("glob");var s=e(require("lodash/last")),c=e(require("lodash/set")),l=e(require("lodash/get")),d=e(require("lodash/escapeRegExp")),u=e(require("lodash/merge")),p=e(require("gulp-replace")),f=e(require("gulp-json-editor")),m=e(require("json5")),h=e(require("gulp-convert")),g=require("colors"),_=e(g),$=require("@rushstack/node-core-library"),w=require("@microsoft/api-extractor-model"),k=require("@microsoft/tsdoc"),y=require("resolve"),v=function(){function e(e){this._$$_implementation=e}return e.prototype.getLinkForApiItem=function(e){return this._$$_implementation.getLinkForApiItem(e)},e}();function b(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function x(e,t,r){return t&&b(e.prototype,t),r&&b(e,r),e}function T(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}var C=function(){},S=function(){function e(e){this.context=e._context}return e.prototype.onInitialized=function(){},e}(),N=function(e){this.apiModel=e.apiModel,this.outputFolder=e.outputFolder,this.documenter=e.documenter},A=function(e){function t(){return e.apply(this,arguments)||this}T(t,e);var r=t.prototype;return r.onBeforeWritePage=function(e){},r.onFinished=function(e){},t}(S),P=process.env,I=P.CWD,D=P.DOC_PROJECT_NAME;function F(e,t){void 0===t&&(t=!1);for(var r=arguments.length,n=new Array(r>2?r-2:0),i=2;i<r;i++)n[i-2]=arguments[i];return t?M.apply(void 0,[e].concat(n)):E.apply(void 0,[e].concat(n))}function E(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return o.join.apply(o,[__dirname,"..",e].concat(r)).replace(/\\/g,"/")}function M(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return o.join.apply(o,[process.env.CWD,e].concat(r)).replace(/\\/g,"/")}function R(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return F.apply(void 0,["./.tmp/api/"+D,!1].concat(t))}function L(e,t){return void 0===t&&(t=".d.ts"),require.resolve(e,{paths:[I]}).replace(".js",t).replace(/\\/g,"/")}var B={docFxTemplate:F("./config/template/memberpage.2.43.2/content"),mainTemplate:F("./config/api-extractor.main.template.json"),template:F("./config/api-extractor.template.json"),tmpProjectDir:R(),tmpEtcDir:R("./etc")},j=process.env,O=j.CWD,Y=j.DOC_MAIN_POINT,U=t.readdirSync(F("./src",!0)).filter((function(e){return t.pathExistsSync(F("./src/"+e+"/index.ts",!0))})),q=t.readFileSync(B.mainTemplate).toString("utf8"),W=t.readFileSync(B.template).toString("utf8");t.pathExistsSync(B.tmpEtcDir)||t.ensureDirSync(B.tmpEtcDir);var H,V=L(Y);function z(){return function(){var e,n=R("index.api.json");return t.existsSync(n)||t.createFileSync(n),t.writeFileSync(n,(void 0===(e=B.tmpProjectDir)&&(e="<projectFolder>"),q.replace(/\$\{projectFolder\}/gi,O).replace(/\<projectFolder\>\/lib\/index.d.ts/gi,V).replace(/\<projectFolder\>\/dist/gi,e+"/dist").replace(/\<projectFolder\>\/etc/gi,e+"/etc").replace(/\<projectFolder\>/gi,e))),console.debug("project_name: "+process.env.DOC_PROJECT_NAME),r.src(n).pipe(i.logger.log("project_name: "+process.env.DOC_PROJECT_NAME)).pipe(i.shell("api-extractor run -c "+n+" --local"))}}function G(e){var n=R(e+".api.json");return function(){return t.existsSync(n)||t.createFileSync(n),t.writeFileSync(n,function(t,r){return void 0===r&&(r="<projectFolder>"),(t=(t=(t=(t=(t=t.replace(/\$\{projectFolder\}/gi,O)).replace(/\<projectFolder\>\/lib/gi,o.parse(V).dir)).replace(/\<projectFolder\>\/dist/gi,r+"/dist")).replace(/\<projectFolder\>\/etc/gi,r+"/etc")).replace(/\<projectFolder\>/gi,r)).replace(/\$\{folderName\}/gi,e)}(W,B.tmpProjectDir)),r.src(n).pipe(i.logger.log("Project Tree Api: "+e)).pipe(i.shell("api-extractor run -c "+n+" --local"))}}JSON.parse=m.parse,function(e){var a=".api.json",o=[];function m(){return 0===o.length&&(o=t.readdirSync(B.tmpEtcDir).filter((function(e){return new RegExp("^(.*?)"+d(a)+"$").test(e)})).map((function(e){return e.replace(a,"")}))),o}function g(e,t,n){return r.src(e).pipe(h({from:"yml",to:"json"})).pipe(f(n)).pipe(h({from:"json",to:"yml"})).pipe(r.dest(t))}e.createApiTask=function(){return function(e){var t=m();if(0===t.length)return i.task("empty",(function(){try{return Promise.resolve(n.sleep(100)).then((function(){return r.src(".",{read:!1}).pipe(i.logger.log("- 无模块目录 -"))}))}catch(e){return Promise.reject(e)}}))(e);console.log(t);var o=t.map((function(e){return function(e){var t=R("./etc/"+(e===D?"index":e)+a);return function(){return r.src(t,{allowEmpty:!0}).pipe(p("@yuyi919/ts-api-docs",e)).pipe(f((function(r){return console.error("modify "+t+" name to "+e),c(r,"name",e),r}))).pipe(r.dest(B.tmpEtcDir))}}("index"===e?D:e)}));return console.error("createApiTask",t),r.parallel(o)(e)}},e.createApiFixedTask=function(e){void 0===e&&(e={});var n=[],i="";return r.parallel(r.series((function(){return n=t.readdirSync(R("./document/articles/")),i=t.readFileSync(R("./document/articles/index.md")).toString().replace("Package","Module"),r.src(F("./config/template/apiDoc/**/*")).pipe(r.dest(R("./document")))}),(function(){var e=m();return i=t.readFileSync(R("./document/articles/index.md")).toString()+"\n\n"+i,t.writeFileSync(R("./document/articles/index.md"),i),g(R("./document/articles/toc.yml"),R("./document/articles"),(function(r){var i=e.filter((function(e){return"index"!==e})).map((function(e){return function e(r,n){var i=r+".md",a=t.readFileSync(R("./document/articles/"+i)).toString(),o=s(r.split(".")),c=l(a.match(new RegExp("\\[("+o+")\\]\\(\\.\\/"+i+"\\)","i")),"[1]",o),d="^"+r+"\\.([a-z0-9])+.md$";return{name:c,homepage:i,items:n.filter((function(e){return new RegExp(d,"ig").test(e)})).map((function(t){return e(t.replace(/\.md$/,""),n)}))}}(e,n)}));return u(r,{items:[l(r,"items[0]")].concat({items:i,homepage:"index.md"})})}))})),(function(){return g(R("./document/src/toc.yml"),R("./document/src"),(function(t){return e=u(t,e)}))}))}}(H||(H={}));var K,J=H,Q=function(){function e(e,t){this.inputFolder=e,this.outputFolder=t}var t=e.prototype;return t.onDefineParameters=function(){},t.buildApiModel=function(){var e=new w.ApiModel;if(!$.FileSystem.exists(this.inputFolder))throw new Error("The input folder does not exist: "+this.inputFolder);$.FileSystem.ensureFolder(this.outputFolder);var t=$.FileSystem.readFolder(this.inputFolder),r=Array.isArray(t),n=0;for(t=r?t:t[Symbol.iterator]();;){var i;if(r){if(n>=t.length)break;i=t[n++]}else{if((n=t.next()).done)break;i=n.value}var o=i;if(o.match(/\.api\.json$/i)){console.log("Reading "+o);var s=a.join(this.inputFolder,o);e.loadPackage(s)}}return this._$$_applyInheritDoc(e,e),e},t._$$_applyInheritDoc=function(e,t){if(e instanceof w.ApiDocumentedItem&&e.tsdocComment){var r=e.tsdocComment.inheritDocTag;if(r&&r.declarationReference){var n=t.resolveDeclarationReference(r.declarationReference,e);n.errorMessage?console.log(g.yellow("Warning: Unresolved @inheritDoc tag for "+e.displayName+": "+n.errorMessage)):n.resolvedApiItem instanceof w.ApiDocumentedItem&&n.resolvedApiItem.tsdocComment&&n.resolvedApiItem!==e&&this._$$_copyInheritedDocs(e.tsdocComment,n.resolvedApiItem.tsdocComment)}}if(w.ApiItemContainerMixin.isBaseClassOf(e)){var i=e.members,a=Array.isArray(i),o=0;for(i=a?i:i[Symbol.iterator]();;){var s;if(a){if(o>=i.length)break;s=i[o++]}else{if((o=i.next()).done)break;s=o.value}this._$$_applyInheritDoc(s,t)}}},t._$$_copyInheritedDocs=function(e,t){e.summarySection=t.summarySection,e.remarksBlock=t.remarksBlock,e.params.clear();var r=t.params,n=Array.isArray(r),i=0;for(r=n?r:r[Symbol.iterator]();;){var a;if(n){if(i>=r.length)break;a=r[i++]}else{if((i=r.next()).done)break;a=i.value}e.params.add(a)}var o=t.typeParams,s=Array.isArray(o),c=0;for(o=s?o:o[Symbol.iterator]();;){var l;if(s){if(c>=o.length)break;l=o[c++]}else{if((c=o.next()).done)break;l=c.value}e.typeParams.add(l)}e.returnsBlock=t.returnsBlock,e.inheritDocTag=void 0},e}(),X=function(e){function t(t,r){var n;return(n=e.call(this,t,r)||this).bold=!!t.bold,n.italic=!!t.italic,n}return T(t,e),x(t,[{key:"kind",get:function(){return"EmphasisSpan"}}]),t}(k.DocNodeContainer),Z=function(e){function t(t){var r;if((r=e.call(this,t)||this).title=t.title,r.level=void 0!==t.level?t.level:1,r.level<1||r.level>5)throw new Error("IDocHeadingParameters.level must be a number between 1 and 5");return r}return T(t,e),x(t,[{key:"kind",get:function(){return"Heading"}}]),t}(k.DocNode),ee=function(e){function t(t,r){var n;return(n=e.call(this,t)||this).content=new k.DocSection({configuration:n.configuration},r),n}return T(t,e),t.prototype.onGetChildNodes=function(){return[this.content]},x(t,[{key:"kind",get:function(){return"NoteBox"}}]),t}(k.DocNode),te=function(e){function t(t,r){var n;return(n=e.call(this,t)||this).content=new k.DocSection({configuration:n.configuration},r),n}return T(t,e),t.prototype.onGetChildNodes=function(){return[this.content]},x(t,[{key:"kind",get:function(){return"IncludeSnippet"}}]),t}(k.DocNode),re=function(e){function t(t,r){var n;return(n=e.call(this,t)||this).content=new k.DocSection({configuration:n.configuration},r),n}return T(t,e),x(t,[{key:"kind",get:function(){return"TableCell"}}]),t}(k.DocNode),ne=function(e){function t(t,r){var n;if((n=e.call(this,t)||this)._$$_cells=[],r){var i=r,a=Array.isArray(i),o=0;for(i=a?i:i[Symbol.iterator]();;){var s;if(a){if(o>=i.length)break;s=i[o++]}else{if((o=i.next()).done)break;s=o.value}n.addCell(s)}}return n}T(t,e);var r=t.prototype;return r.addCell=function(e){this._$$_cells.push(e)},r.createAndAddCell=function(){var e=new re({configuration:this.configuration});return this.addCell(e),e},r.addPlainTextCell=function(e){var t=this.createAndAddCell();return t.content.appendNodeInParagraph(new k.DocPlainText({configuration:this.configuration,text:e})),t},r.onGetChildNodes=function(){return this._$$_cells},x(t,[{key:"kind",get:function(){return"TableRow"}},{key:"cells",get:function(){return this._$$_cells}}]),t}(k.DocNode),ie=function(e){function t(t,r){var n;if((n=e.call(this,t)||this).header=new ne({configuration:n.configuration}),n._$$_rows=[],t)if(t.headerTitles){if(t.headerCells)throw new Error("IDocTableParameters.headerCells and IDocTableParameters.headerTitles cannot both be specified");var i=t.headerTitles,a=Array.isArray(i),o=0;for(i=a?i:i[Symbol.iterator]();;){var s;if(a){if(o>=i.length)break;s=i[o++]}else{if((o=i.next()).done)break;s=o.value}n.header.addPlainTextCell(s)}}else if(t.headerCells){var c=t.headerCells,l=Array.isArray(c),d=0;for(c=l?c:c[Symbol.iterator]();;){var u;if(l){if(d>=c.length)break;u=c[d++]}else{if((d=c.next()).done)break;u=d.value}n.header.addCell(u)}}if(r){var p=r,f=Array.isArray(p),m=0;for(p=f?p:p[Symbol.iterator]();;){var h;if(f){if(m>=p.length)break;h=p[m++]}else{if((m=p.next()).done)break;h=m.value}n.addRow(h)}}return n}T(t,e);var r=t.prototype;return r.addRow=function(e){this._$$_rows.push(e)},r.createAndAddRow=function(){var e=new ne({configuration:this.configuration});return this.addRow(e),e},r.onGetChildNodes=function(){return[this.header].concat(this._$$_rows)},x(t,[{key:"kind",get:function(){return"Table"}},{key:"rows",get:function(){return this._$$_rows}}]),t}(k.DocNode);!function(e){e.Block="Block",e.BlockTag="BlockTag",e.Excerpt="Excerpt",e.FencedCode="FencedCode",e.CodeSpan="CodeSpan",e.Comment="Comment",e.DeclarationReference="DeclarationReference",e.ErrorText="ErrorText",e.EscapedText="EscapedText",e.HtmlAttribute="HtmlAttribute",e.HtmlEndTag="HtmlEndTag",e.HtmlStartTag="HtmlStartTag",e.InheritDocTag="InheritDocTag",e.InlineTag="InlineTag",e.LinkTag="LinkTag",e.MemberIdentifier="MemberIdentifier",e.MemberReference="MemberReference",e.MemberSelector="MemberSelector",e.MemberSymbol="MemberSymbol",e.Paragraph="Paragraph",e.ParamBlock="ParamBlock",e.ParamCollection="ParamCollection",e.PlainText="PlainText",e.Section="Section",e.SoftBreak="SoftBreak"}(K||(K={}));var ae=function(){function e(){}return x(e,null,[{key:"configuration",get:function(){if(void 0===e._configuration){var t=new k.TSDocConfiguration;t.docNodeManager.registerDocNodes("@micrososft/api-documenter",[{docNodeKind:"EmphasisSpan",constructor:X},{docNodeKind:"Heading",constructor:Z},{docNodeKind:"IncludeSnippet",constructor:te},{docNodeKind:"NoteBox",constructor:ee},{docNodeKind:"Table",constructor:ie},{docNodeKind:"TableCell",constructor:re},{docNodeKind:"TableRow",constructor:ne}]),t.docNodeManager.registerAllowableChildren("EmphasisSpan",["IncludeSnippet",K.PlainText,K.SoftBreak]),t.docNodeManager.registerAllowableChildren(K.Section,["IncludeSnippet","Heading","NoteBox","Table"]),t.docNodeManager.registerAllowableChildren(K.Paragraph,["EmphasisSpan"]);var r={tagName:"@includeSnippet",tagNameWithUpperCase:"@INCLUDESNIPPET",syntaxKind:0,standardization:"Core",allowMultiple:!1};t.addTagDefinitions([r],!0),e._configuration=t,t.setSupportForTag(r,!0),console.log(t.tagDefinitions)}return e._configuration}}]),e}(),oe=function(){function e(){}return e.getConciseSignature=function(e){return w.ApiParameterListMixin.isBaseClassOf(e)?e.displayName+"("+e.parameters.map((function(e){return e.name})).join(", ")+")":e.displayName},e.getSafeFilenameForName=function(t){return t.replace(e._badFilenameCharsRegExp,"_").toLowerCase()},e}();oe._badFilenameCharsRegExp=/[^a-z0-9_\-\.]/gi;var se,ce,le,de,ue=function(){function e(e){this.defaultIndentPrefix="  ",this._$$_builder=void 0===e?new $.StringBuilder:e,this._$$_latestChunk=void 0,this._$$_previousChunk=void 0,this._$$_atStartOfLine=!0,this._$$_indentStack=[],this._$$_indentText=""}var t=e.prototype;return t.getText=function(){return this._$$_builder.toString()},t.toString=function(){return this.getText()},t.increaseIndent=function(e){this._$$_indentStack.push(void 0!==e?e:this.defaultIndentPrefix),this._$$_updateIndentText()},t.decreaseIndent=function(){this._$$_indentStack.pop(),this._$$_updateIndentText()},t.indentScope=function(e,t){this.increaseIndent(t),e(),this.decreaseIndent()},t.ensureNewLine=function(){var e=this.peekLastCharacter();"\n"!==e&&""!==e&&this._$$_writeNewLine()},t.ensureSkippedLine=function(){"\n"!==this.peekLastCharacter()&&this._$$_writeNewLine();var e=this.peekSecondLastCharacter();"\n"!==e&&""!==e&&this._$$_writeNewLine()},t.peekLastCharacter=function(){return void 0!==this._$$_latestChunk?this._$$_latestChunk.substr(-1,1):""},t.peekSecondLastCharacter=function(){if(void 0!==this._$$_latestChunk){if(this._$$_latestChunk.length>1)return this._$$_latestChunk.substr(-2,1);if(void 0!==this._$$_previousChunk)return this._$$_previousChunk.substr(-1,1)}return""},t.write=function(e){if(0!==e.length)if(/[\r\n]/.test(e)){var t=!0,r=e.split("\n"),n=Array.isArray(r),i=0;for(r=n?r:r[Symbol.iterator]();;){var a;if(n){if(i>=r.length)break;a=r[i++]}else{if((i=r.next()).done)break;a=i.value}var o=a;t?t=!1:this._$$_writeNewLine(),o&&this._$$_writeLinePart(o.replace(/[\r]/g,""))}}else this._$$_writeLinePart(e)},t.writeLine=function(e){void 0===e&&(e=""),e.length>0&&this.write(e),this._$$_writeNewLine()},t._$$_writeLinePart=function(e){e.length>0&&(this._$$_atStartOfLine&&this._$$_indentText.length>0&&this._$$_write(this._$$_indentText),this._$$_write(e),this._$$_atStartOfLine=!1)},t._$$_writeNewLine=function(){this._$$_atStartOfLine&&this._$$_indentText.length>0&&this._$$_write(this._$$_indentText),this._$$_write("\n"),this._$$_atStartOfLine=!0},t._$$_write=function(e){this._$$_previousChunk=this._$$_latestChunk,this._$$_latestChunk=e,this._$$_builder.append(e)},t._$$_updateIndentText=function(){this._$$_indentText=this._$$_indentStack.join("")},e}();!function(e){e.CallSignature="CallSignature",e.Class="Class",e.Constructor="Constructor",e.ConstructSignature="ConstructSignature",e.EntryPoint="EntryPoint",e.Enum="Enum",e.EnumMember="EnumMember",e.Function="Function",e.IndexSignature="IndexSignature",e.Interface="Interface",e.Method="Method",e.MethodSignature="MethodSignature",e.Model="Model",e.Namespace="Namespace",e.Package="Package",e.Property="Property",e.PropertySignature="PropertySignature",e.TypeAlias="TypeAlias",e.Variable="Variable",e.None="None"}(se||(se={})),function(e){e.Content="Content",e.Reference="Reference"}(ce||(ce={})),function(e){e.Block="Block",e.BlockTag="BlockTag",e.Excerpt="Excerpt",e.FencedCode="FencedCode",e.CodeSpan="CodeSpan",e.Comment="Comment",e.DeclarationReference="DeclarationReference",e.ErrorText="ErrorText",e.EscapedText="EscapedText",e.HtmlAttribute="HtmlAttribute",e.HtmlEndTag="HtmlEndTag",e.HtmlStartTag="HtmlStartTag",e.InheritDocTag="InheritDocTag",e.InlineTag="InlineTag",e.LinkTag="LinkTag",e.MemberIdentifier="MemberIdentifier",e.MemberReference="MemberReference",e.MemberSelector="MemberSelector",e.MemberSymbol="MemberSymbol",e.Paragraph="Paragraph",e.ParamBlock="ParamBlock",e.ParamCollection="ParamCollection",e.PlainText="PlainText",e.Section="Section",e.SoftBreak="SoftBreak"}(le||(le={})),function(e){e.CrLf="\r\n",e.Lf="\n",e.OsDefault="os"}(de||(de={}));var pe=function(e){function t(t){var r;return(r=e.call(this)||this)._$$_apiModel=t,r}T(t,e);var r=t.prototype;return r.emit=function(t,r,n){return e.prototype.emit.call(this,t,r,n)},r.writeNode=function(t,r,n){var i=r.writer;switch(t.kind){case"Heading":var a,o=t;switch(i.ensureSkippedLine(),o.level){case 1:a="##";break;case 2:case 3:a="###";break;default:a="####"}i.writeLine(a+" "+this.getEscapedText(o.title)),i.writeLine();break;case"NoteBox":var s=t;i.ensureNewLine(),i.increaseIndent("> "),this.writeNode(s.content,r,!1),i.ensureNewLine(),i.decreaseIndent(),i.writeLine();break;case"Table":var c=t;i.ensureSkippedLine(),r.insideTable=!0;var l=0;c.header&&(l=c.header.cells.length);var d=c.rows,u=Array.isArray(d),p=0;for(d=u?d:d[Symbol.iterator]();;){var f;if(u){if(p>=d.length)break;f=d[p++]}else{if((p=d.next()).done)break;f=p.value}f.cells.length>l&&(l=f.cells.length)}i.write("| ");for(var m=0;m<l;++m){if(i.write(" "),c.header){var h=c.header.cells[m];h&&this.writeNode(h.content,r,!1)}i.write(" |")}i.writeLine(),i.write("| ");for(var g=0;g<l;++g)i.write(" --- |");i.writeLine();var _=c.rows,$=Array.isArray(_),w=0;for(_=$?_:_[Symbol.iterator]();;){var k;if($){if(w>=_.length)break;k=_[w++]}else{if((w=_.next()).done)break;k=w.value}var y=k;i.write("| ");var v=y.cells,b=Array.isArray(v),x=0;for(v=b?v:v[Symbol.iterator]();;){var T;if(b){if(x>=v.length)break;T=v[x++]}else{if((x=v.next()).done)break;T=x.value}var C=T;i.write(" "),this.writeNode(C.content,r,!1),i.write(" |")}i.writeLine()}i.writeLine(),r.insideTable=!1;break;case"EmphasisSpan":var S=t,N=r.boldRequested,A=r.italicRequested;r.boldRequested=S.bold,r.italicRequested=S.italic,this.writeNodes(S.nodes,r),r.boldRequested=N,r.italicRequested=A;break;default:e.prototype.writeNode.call(this,t,r,!1)}},r.writeLinkTagWithCodeDestination=function(e,t){var r=t.options,n=this._$$_apiModel.resolveDeclarationReference(e.codeDestination,r.contextApiItem);if(n.resolvedApiItem){var i=r.onGetFilenameForApiItem(n.resolvedApiItem);if(i){var a=e.linkText||"";if(0===a.length&&(a=n.resolvedApiItem.getScopedNameWithinPackage()),a.length>0){var o=this.getEscapedText(a.replace(/\s+/g," "));t.writer.write("["),t.writer.write(o),t.writer.write("]("+i+")")}else console.log(_.yellow("WARNING: Unable to determine link text"))}}else n.errorMessage&&console.log(_.yellow('WARNING: Unable to resolve reference "'+e.codeDestination.emitAsTsdoc()+'": '+n.errorMessage))},t}(function(){function e(){}var t=e.prototype;return t.emit=function(e,t,r){var n=new ue(e);return this.writeNode(t,{writer:n,insideTable:!1,boldRequested:!1,italicRequested:!1,writingBold:!1,writingItalic:!1,options:r},!1),n.ensureNewLine(),n.toString()},t.getEscapedText=function(e){return e.replace(/\\/g,"\\\\").replace(/[*#[\]_|`~]/g,(function(e){return"\\"+e})).replace(/---/g,"\\-\\-\\-").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},t.getTableEscapedText=function(e){return e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\|/g,"&#124;")},t.writeNode=function(e,t,r){var n=t.writer;switch(e.kind){case le.PlainText:this.writePlainText(e.text,t);break;case le.HtmlStartTag:case le.HtmlEndTag:n.write(e.emitAsHtml());break;case le.CodeSpan:var i=e;if(n.write(t.insideTable?"<code>":"`"),t.insideTable){var a=this.getTableEscapedText(i.code).split(/\r?\n/g);n.write(a.join("</code><br/><code>"))}else n.write(i.code);n.write(t.insideTable?"</code>":"`");break;case le.LinkTag:var o=e;o.codeDestination?this.writeLinkTagWithCodeDestination(o,t):o.urlDestination?this.writeLinkTagWithUrlDestination(o,t):o.linkText&&this.writePlainText(o.linkText,t);break;case le.Paragraph:var s=k.DocNodeTransforms.trimSpacesInParagraph(e);t.insideTable?r?(n.write("<p>"),this.writeNodes(s.nodes,t),n.write("</p>")):this.writeNodes(s.nodes,t):(this.writeNodes(s.nodes,t),n.ensureNewLine(),n.writeLine());break;case le.FencedCode:var c=e;n.ensureNewLine(),n.write("```"),n.write(c.language),n.writeLine(),n.write(c.code),n.writeLine(),n.writeLine("```");break;case le.Section:this.writeNodes(e.nodes,t);break;case le.SoftBreak:/^\s?$/.test(n.peekLastCharacter())||n.write(" ");break;case le.EscapedText:this.writePlainText(e.decodedText,t);break;case le.ErrorText:this.writePlainText(e.text,t);break;case le.InlineTag:break;case le.BlockTag:var l=e;"@includeSnippet"===l.tagName?(console.warn("Hellow World: "+l.tagName),this.writePlainText(l.tagName,t)):console.warn("Unsupported block tag: "+l.tagName);break;default:throw new $.InternalError("Unsupported DocNodeKind kind: "+e.kind)}},t.writeLinkTagWithCodeDestination=function(e,t){throw new $.InternalError("writeLinkTagWithCodeDestination()")},t.writeLinkTagWithUrlDestination=function(e,t){var r=this.getEscapedText((void 0!==e.linkText?e.linkText:e.urlDestination).replace(/\s+/g," "));t.writer.write("["),t.writer.write(r),t.writer.write("]("+e.urlDestination+")")},t.writePlainText=function(e,t){var r=t.writer,n=e.match(/^(\s*)(.*?)(\s*)$/)||[];r.write(n[1]);var i=n[2];if(""!==i){switch(r.peekLastCharacter()){case"":case"\n":case" ":case"[":case">":break;default:r.write("\x3c!-- --\x3e")}t.boldRequested&&r.write("<b>"),t.italicRequested&&r.write("<i>"),r.write(this.getEscapedText(i)),t.italicRequested&&r.write("</i>"),t.boldRequested&&r.write("</b>")}r.write(n[3])},t.writeNodes=function(e,t){var r=e,n=Array.isArray(r),i=0;for(r=n?r:r[Symbol.iterator]();;){var a;if(n){if(i>=r.length)break;a=r[i++]}else{if((i=r.next()).done)break;a=i.value}this.writeNode(a,t,e.length>1)}},e}()),fe=function(){function e(){}return e.prototype.load=function(e,t){var r=a.dirname(e.configFilePath),n=e.configFile.plugins||[],i=Array.isArray(n),o=0;for(n=i?n:n[Symbol.iterator]();;){var s;if(i){if(o>=n.length)break;s=n[o++]}else{if((o=n.next()).done)break;s=o.value}var c=s;try{var l=y.sync(c.packageName,{basedir:r}),d=require(l);if(!d)throw new Error("Invalid entry point");var u=d.apiDocumenterPluginManifest;if(!u)throw new Error('The package is not an API documenter plugin; the "apiDocumenterPluginManifest" export was not found');if(1e3!==u.manifestVersion)throw new Error("The plugin is not compatible with this version of API Documenter; unsupported manifestVersion");var p={packageName:c.packageName,manifest:u},f=new Map,m=u.features,h=Array.isArray(m),g=0;for(m=h?m:m[Symbol.iterator]();;){var _;if(h){if(g>=m.length)break;_=m[g++]}else{if((g=m.next()).done)break;_=g.value}f.set(_.featureName,_)}var $=c.enabledFeatureNames,w=Array.isArray($),k=0;for($=w?$:$[Symbol.iterator]();;){var v;if(w){if(k>=$.length)break;v=$[k++]}else{if((k=$.next()).done)break;v=k.value}var b=v,x=f.get(b);if(!x)throw new Error("The plugin "+p.packageName+' does not have a feature with name "'+b+'"');if("MarkdownDocumenterFeature"!==x.kind)throw new Error('Unknown feature definition kind: "'+x.kind+'"');if(this.markdownDocumenterFeature)throw new Error("A MarkdownDocumenterFeature is already loaded");var T=new C;T._context=t();var S=void 0;try{S=new x.subclass(T)}catch(e){throw new Error("Failed to construct feature subclass:\n"+e.toString())}if(!(S instanceof A))throw new Error("The constructed subclass was not an instance of MarkdownDocumenterFeature");try{S.onInitialized()}catch(e){throw new Error("Error occurred during the onInitialized() event: "+e.toString())}this.markdownDocumenterFeature=S}}catch(e){throw new Error("Error loading plugin "+c.packageName+": "+e.message)}}},e}(),me=function(){function e(e,t,r){this.projectFolder=t,this._$$_apiModel=e,this._$$_documenterConfig=r,this._$$_tsdocConfiguration=ae.configuration,this._$$_markdownEmitter=new pe(this._$$_apiModel),this._$$_pluginLoader=new fe}var t=e.prototype;return t.generateFiles=function(e){var t=this;this._$$_outputFolder=e,this._$$_documenterConfig&&this._$$_pluginLoader.load(this._$$_documenterConfig,(function(){return new N({apiModel:t._$$_apiModel,outputFolder:e,documenter:new v({getLinkForApiItem:function(e){return t._$$_getLinkFilenameForApiItem(e)}})})})),console.log(),this._$$_deleteOldOutputFiles(),this._$$_writeApiItemPage(this._$$_apiModel),this._$$_pluginLoader.markdownDocumenterFeature&&this._$$_pluginLoader.markdownDocumenterFeature.onFinished({})},t._$$_writeApiItemPage=function(e){var t=this,r=this._$$_tsdocConfiguration,n=new k.DocSection({configuration:this._$$_tsdocConfiguration});this._$$_writeBreadcrumb(n,e);var i=e.getScopedNameWithinPackage();switch(e.kind){case"Class":n.appendNode(new Z({configuration:r,title:i+" class"}));break;case"Enum":n.appendNode(new Z({configuration:r,title:i+" enum"}));break;case"Interface":n.appendNode(new Z({configuration:r,title:i+" interface"}));break;case"Constructor":case"ConstructSignature":n.appendNode(new Z({configuration:r,title:i}));break;case"Method":case"MethodSignature":n.appendNode(new Z({configuration:r,title:i+" method"}));break;case"Function":n.appendNode(new Z({configuration:r,title:i+" function"}));break;case"Model":n.appendNode(new Z({configuration:r,title:"API Reference"}));break;case"Namespace":n.appendNode(new Z({configuration:r,title:i+" namespace"}));break;case"Package":console.log("Writing "+e.displayName+" package");var o=$.PackageName.getUnscopedName(e.displayName);n.appendNode(new Z({configuration:r,title:o+" package"}));break;case"Property":case"PropertySignature":n.appendNode(new Z({configuration:r,title:i+" property"}));break;case"TypeAlias":n.appendNode(new Z({configuration:r,title:i+" type"}));break;case"Variable":n.appendNode(new Z({configuration:r,title:i+" variable"}));break;default:throw new Error("Unsupported API item kind: "+e.kind)}if(w.ApiReleaseTagMixin.isBaseClassOf(e)&&e.releaseTag===w.ReleaseTag.Beta&&this._$$_writeBetaWarning(n),e instanceof w.ApiDocumentedItem){var s=e.tsdocComment;s&&(s.deprecatedBlock&&n.appendNode(new ee({configuration:this._$$_tsdocConfiguration},[new k.DocParagraph({configuration:this._$$_tsdocConfiguration},[new k.DocPlainText({configuration:this._$$_tsdocConfiguration,text:"Warning: This API is now obsolete. "})])].concat(s.deprecatedBlock.content.nodes))),this._$$_appendSection(n,s.summarySection))}e instanceof w.ApiDeclaredItem&&e.excerpt.text.length>0&&(n.appendNode(new k.DocParagraph({configuration:r},[new X({configuration:r,bold:!0},[new k.DocPlainText({configuration:r,text:"Signature:"})])])),n.appendNode(new k.DocFencedCode({configuration:r,code:e.getExcerptWithModifiers(),language:"typescript"})));var c=!0;switch(e.kind){case"Class":case"Interface":case"Namespace":case"Package":this._$$_writeRemarksSection(n,e),c=!1}switch(e.kind){case"Class":var l=e.tsdocComment;if(l){var d=this._$$getSummaryConnect(n,l.summarySection);d&&this._$$_appendSection(n,new k.DocSection({configuration:this._$$_tsdocConfiguration},[d]))}this._$$_writeClassTables(n,e);break;case"Enum":this._$$_writeEnumTables(n,e);break;case"Interface":this._$$_writeInterfaceTables(n,e);break;case"Constructor":case"ConstructSignature":case"Method":case"MethodSignature":case"Function":this._$$_writeParameterTables(n,e),this._$$_writeThrowsSection(n,e);break;case"Namespace":this._$$_writePackageOrNamespaceTables(n,e);break;case"Model":this._$$_writeModelTable(n,e);break;case"Package":this._$$_writePackageOrNamespaceTables(n,e);break;case"Property":case"PropertySignature":case"TypeAlias":case"Variable":break;default:throw new Error("Unsupported API item kind: "+e.kind)}c&&this._$$_writeRemarksSection(n,e);var u=a.join(this._$$_outputFolder,this._$$_getFilenameForApiItem(e)),p=new k.StringBuilder;p.append("\x3c!-- Do not edit this file. It is automatically generated by API Documenter. --\x3e\n\n"),this._$$_markdownEmitter.emit(p,n,{contextApiItem:e,onGetFilenameForApiItem:function(e){return t._$$_getLinkFilenameForApiItem(e)}});var f=p.toString();if(this._$$_pluginLoader.markdownDocumenterFeature){var m={apiItem:e,outputFilename:u,pageContent:f};this._$$_pluginLoader.markdownDocumenterFeature.onBeforeWritePage(m),f=m.pageContent}$.FileSystem.writeFile(u,f,{vertLineEndings:this._$$_documenterConfig?this._$$_documenterConfig.newlineKind:"\r\n"})},t._$$_writeRemarksSection=function(e,t){if(t instanceof w.ApiDocumentedItem){var r=t.tsdocComment;if(r){r.remarksBlock&&(e.appendNode(new Z({configuration:this._$$_tsdocConfiguration,title:"Remarks"})),this._$$_appendSection(e,r.remarksBlock.content));var n=r.customBlocks.filter((function(e){return e.blockTag.tagNameWithUpperCase===k.StandardTags.example.tagNameWithUpperCase})),i=1,a=n,o=Array.isArray(a),s=0;for(a=o?a:a[Symbol.iterator]();;){var c;if(o){if(s>=a.length)break;c=a[s++]}else{if((s=a.next()).done)break;c=s.value}var l=c;e.appendNode(new Z({configuration:this._$$_tsdocConfiguration,title:n.length>1?"Example "+i:"Example"})),this._$$_appendSection(e,l.content),++i}}}},t._$$getSummaryConnect=function(e,t,r){if(void 0===r&&(r=[]),!t)return null;if(t.kind===le.BlockTag&&"@includeSnippet"===t._tagName){var n=t,i=r[r.length-1],o=i.getChildNodes()[i.getChildNodes().findIndex((function(e){return e===t}))+1];if(o.kind===le.PlainText){var s=o.text,c=s.split("#")[0];if(c){var l=a.relative(process.cwd(),c.replace(/^( )+/,"").replace("~",this.projectFolder));console.log(n.kind,s,l);var d=$.FileSystem.readFile(l);return i.clearNodes(),new k.DocFencedCode({code:d,language:"ts",configuration:this._$$_tsdocConfiguration})}}}else if(t.kind===le.Section||"Paragraph"===t.kind||"SoftBreak"===t.kind){var u=t.getChildNodes(),p=Array.isArray(u),f=0;for(u=p?u:u[Symbol.iterator]();;){var m;if(p){if(f>=u.length)break;m=u[f++]}else{if((f=u.next()).done)break;m=f.value}var h=this._$$getSummaryConnect(e,m,[].concat(r,[t]));if(h)return h}}return null},t._$$_writeThrowsSection=function(e,t){if(t instanceof w.ApiDocumentedItem){var r=t.tsdocComment;if(r){var n=r.customBlocks.filter((function(e){return e.blockTag.tagNameWithUpperCase===k.StandardTags.throws.tagNameWithUpperCase}));if(n.length>0){e.appendNode(new Z({configuration:this._$$_tsdocConfiguration,title:"Exceptions"}));var i=n,a=Array.isArray(i),o=0;for(i=a?i:i[Symbol.iterator]();;){var s;if(a){if(o>=i.length)break;s=i[o++]}else{if((o=i.next()).done)break;s=o.value}this._$$_appendSection(e,s.content)}}}}},t._$$_writeModelTable=function(e,t){var r=this._$$_tsdocConfiguration,n=new ie({configuration:r,headerTitles:["Package","Description"]}),i=t.members,a=Array.isArray(i),o=0;for(i=a?i:i[Symbol.iterator]();;){var s;if(a){if(o>=i.length)break;s=i[o++]}else{if((o=i.next()).done)break;s=o.value}var c=s,l=new ne({configuration:r},[this._$$_createTitleCell(c),this._$$_createDescriptionCell(c)]);switch(c.kind){case"Package":n.addRow(l),this._$$_writeApiItemPage(c)}}n.rows.length>0&&(e.appendNode(new Z({configuration:this._$$_tsdocConfiguration,title:"Packages"})),e.appendNode(n))},t._$$_writePackageOrNamespaceTables=function(e,t){var r=this._$$_tsdocConfiguration,n=new ie({configuration:r,headerTitles:["Class","Description"]}),i=new ie({configuration:r,headerTitles:["Enumeration","Description"]}),a=new ie({configuration:r,headerTitles:["Function","Description"]}),o=new ie({configuration:r,headerTitles:["Interface","Description"]}),s=new ie({configuration:r,headerTitles:["Namespace","Description"]}),c=new ie({configuration:r,headerTitles:["Variable","Description"]}),l=new ie({configuration:r,headerTitles:["Type Alias","Description"]}),d="Package"===t.kind?t.entryPoints[0].members:t.members,u=Array.isArray(d),p=0;for(d=u?d:d[Symbol.iterator]();;){var f;if(u){if(p>=d.length)break;f=d[p++]}else{if((p=d.next()).done)break;f=p.value}var m=f,h=new ne({configuration:r},[this._$$_createTitleCell(m),this._$$_createDescriptionCell(m)]);switch(m.kind){case"Class":n.addRow(h),this._$$_writeApiItemPage(m);break;case"Enum":i.addRow(h),this._$$_writeApiItemPage(m);break;case"Interface":o.addRow(h),this._$$_writeApiItemPage(m);break;case"Namespace":s.addRow(h),this._$$_writeApiItemPage(m);break;case"Function":a.addRow(h),this._$$_writeApiItemPage(m);break;case"TypeAlias":l.addRow(h),this._$$_writeApiItemPage(m);break;case"Variable":c.addRow(h),this._$$_writeApiItemPage(m)}}n.rows.length>0&&(e.appendNode(new Z({configuration:this._$$_tsdocConfiguration,title:"Classes"})),e.appendNode(n)),i.rows.length>0&&(e.appendNode(new Z({configuration:this._$$_tsdocConfiguration,title:"Enumerations"})),e.appendNode(i)),a.rows.length>0&&(e.appendNode(new Z({configuration:this._$$_tsdocConfiguration,title:"Functions"})),e.appendNode(a)),o.rows.length>0&&(e.appendNode(new Z({configuration:this._$$_tsdocConfiguration,title:"Interfaces"})),e.appendNode(o)),s.rows.length>0&&(e.appendNode(new Z({configuration:this._$$_tsdocConfiguration,title:"Namespaces"})),e.appendNode(s)),c.rows.length>0&&(e.appendNode(new Z({configuration:this._$$_tsdocConfiguration,title:"Variables"})),e.appendNode(c)),l.rows.length>0&&(e.appendNode(new Z({configuration:this._$$_tsdocConfiguration,title:"Type Aliases"})),e.appendNode(l))},t._$$_writeClassTables=function(e,t){var r=this._$$_tsdocConfiguration,n=new ie({configuration:r,headerTitles:["Property","Modifiers","Type","Description"]}),i=new ie({configuration:r,headerTitles:["Constructor","Modifiers","Description"]}),a=new ie({configuration:r,headerTitles:["Property","Modifiers","Type","Description"]}),o=new ie({configuration:r,headerTitles:["Method","Modifiers","Description"]}),s=t.members,c=Array.isArray(s),l=0;for(s=c?s:s[Symbol.iterator]();;){var d;if(c){if(l>=s.length)break;d=s[l++]}else{if((l=s.next()).done)break;d=l.value}var u=d;switch(u.kind){case"Constructor":i.addRow(new ne({configuration:r},[this._$$_createTitleCell(u),this._$$_createModifiersCell(u),this._$$_createDescriptionCell(u)])),this._$$_writeApiItemPage(u);break;case"Method":o.addRow(new ne({configuration:r},[this._$$_createTitleCell(u),this._$$_createModifiersCell(u),this._$$_createDescriptionCell(u)])),this._$$_writeApiItemPage(u);break;case"Property":u.isEventProperty?n.addRow(new ne({configuration:r},[this._$$_createTitleCell(u),this._$$_createModifiersCell(u),this._$$_createPropertyTypeCell(u),this._$$_createDescriptionCell(u)])):a.addRow(new ne({configuration:r},[this._$$_createTitleCell(u),this._$$_createModifiersCell(u),this._$$_createPropertyTypeCell(u),this._$$_createDescriptionCell(u)])),this._$$_writeApiItemPage(u)}}n.rows.length>0&&(e.appendNode(new Z({configuration:this._$$_tsdocConfiguration,title:"Events"})),e.appendNode(n)),i.rows.length>0&&(e.appendNode(new Z({configuration:this._$$_tsdocConfiguration,title:"Constructors"})),e.appendNode(i)),a.rows.length>0&&(e.appendNode(new Z({configuration:this._$$_tsdocConfiguration,title:"Properties"})),e.appendNode(a)),o.rows.length>0&&(e.appendNode(new Z({configuration:this._$$_tsdocConfiguration,title:"Methods"})),e.appendNode(o))},t._$$_writeEnumTables=function(e,t){var r=this._$$_tsdocConfiguration,n=new ie({configuration:r,headerTitles:["Member","Value","Description"]}),i=t.members,a=Array.isArray(i),o=0;for(i=a?i:i[Symbol.iterator]();;){var s;if(a){if(o>=i.length)break;s=i[o++]}else{if((o=i.next()).done)break;s=o.value}var c=s;n.addRow(new ne({configuration:r},[new re({configuration:r},[new k.DocParagraph({configuration:r},[new k.DocPlainText({configuration:r,text:oe.getConciseSignature(c)})])]),new re({configuration:r},[new k.DocParagraph({configuration:r},[new k.DocCodeSpan({configuration:r,code:c.initializerExcerpt.text})])]),this._$$_createDescriptionCell(c)]))}n.rows.length>0&&(e.appendNode(new Z({configuration:this._$$_tsdocConfiguration,title:"Enumeration Members"})),e.appendNode(n))},t._$$_writeInterfaceTables=function(e,t){var r=this._$$_tsdocConfiguration,n=new ie({configuration:r,headerTitles:["Property","Type","Description"]}),i=new ie({configuration:r,headerTitles:["Property","Type","Description"]}),a=new ie({configuration:r,headerTitles:["Method","Description"]}),o=t.members,s=Array.isArray(o),c=0;for(o=s?o:o[Symbol.iterator]();;){var l;if(s){if(c>=o.length)break;l=o[c++]}else{if((c=o.next()).done)break;l=c.value}var d=l;switch(d.kind){case"ConstructSignature":case"MethodSignature":a.addRow(new ne({configuration:r},[this._$$_createTitleCell(d),this._$$_createDescriptionCell(d)])),this._$$_writeApiItemPage(d);break;case"PropertySignature":d.isEventProperty?n.addRow(new ne({configuration:r},[this._$$_createTitleCell(d),this._$$_createPropertyTypeCell(d),this._$$_createDescriptionCell(d)])):i.addRow(new ne({configuration:r},[this._$$_createTitleCell(d),this._$$_createPropertyTypeCell(d),this._$$_createDescriptionCell(d)])),this._$$_writeApiItemPage(d)}}n.rows.length>0&&(e.appendNode(new Z({configuration:this._$$_tsdocConfiguration,title:"Events"})),e.appendNode(n)),i.rows.length>0&&(e.appendNode(new Z({configuration:this._$$_tsdocConfiguration,title:"Properties"})),e.appendNode(i)),a.rows.length>0&&(e.appendNode(new Z({configuration:this._$$_tsdocConfiguration,title:"Methods"})),e.appendNode(a))},t._$$_writeParameterTables=function(e,t){var r=this._$$_tsdocConfiguration,n=new ie({configuration:r,headerTitles:["Parameter","Type","Description"]}),i=t.parameters,a=Array.isArray(i),o=0;for(i=a?i:i[Symbol.iterator]();;){var s;if(a){if(o>=i.length)break;s=i[o++]}else{if((o=i.next()).done)break;s=o.value}var c=s,l=new k.DocSection({configuration:r});c.tsdocParamBlock&&this._$$_appendSection(l,c.tsdocParamBlock.content),n.addRow(new ne({configuration:r},[new re({configuration:r},[new k.DocParagraph({configuration:r},[new k.DocPlainText({configuration:r,text:c.name})])]),new re({configuration:r},[new k.DocParagraph({configuration:r},[new k.DocCodeSpan({configuration:r,code:c.parameterTypeExcerpt.text})])]),new re({configuration:r},l.nodes)]))}if(n.rows.length>0&&(e.appendNode(new Z({configuration:this._$$_tsdocConfiguration,title:"Parameters"})),e.appendNode(n)),w.ApiReturnTypeMixin.isBaseClassOf(t)){var d=t.returnTypeExcerpt;e.appendNode(new k.DocParagraph({configuration:r},[new X({configuration:r,bold:!0},[new k.DocPlainText({configuration:r,text:"Returns:"})])])),e.appendNode(new k.DocParagraph({configuration:r},[new k.DocCodeSpan({configuration:r,code:d.text.trim()||"(not declared)"})])),t instanceof w.ApiDocumentedItem&&t.tsdocComment&&t.tsdocComment.returnsBlock&&this._$$_appendSection(e,t.tsdocComment.returnsBlock.content)}},t._$$_createTitleCell=function(e){var t=this._$$_tsdocConfiguration;return new re({configuration:t},[new k.DocParagraph({configuration:t},[new k.DocLinkTag({configuration:t,tagName:"@link",linkText:oe.getConciseSignature(e),urlDestination:this._$$_getLinkFilenameForApiItem(e)})])])},t._$$_createDescriptionCell=function(e){var t=this._$$_tsdocConfiguration,r=new k.DocSection({configuration:t});return w.ApiReleaseTagMixin.isBaseClassOf(e)&&e.releaseTag===w.ReleaseTag.Beta&&r.appendNodesInParagraph([new X({configuration:t,bold:!0,italic:!0},[new k.DocPlainText({configuration:t,text:"(BETA)"})]),new k.DocPlainText({configuration:t,text:" "})]),e instanceof w.ApiDocumentedItem&&void 0!==e.tsdocComment&&this._$$_appendAndMergeSection(r,e.tsdocComment.summarySection),new re({configuration:t},r.nodes)},t._$$_createModifiersCell=function(e){var t=this._$$_tsdocConfiguration,r=new k.DocSection({configuration:t});return w.ApiStaticMixin.isBaseClassOf(e)&&e.isStatic&&r.appendNodeInParagraph(new k.DocCodeSpan({configuration:t,code:"static"})),new re({configuration:t},r.nodes)},t._$$_createPropertyTypeCell=function(e){var t=this._$$_tsdocConfiguration,r=new k.DocSection({configuration:t});return e instanceof w.ApiPropertyItem&&r.appendNodeInParagraph(new k.DocCodeSpan({configuration:t,code:e.propertyTypeExcerpt.text})),new re({configuration:t},r.nodes)},t._$$_writeBreadcrumb=function(e,t){e.appendNodeInParagraph(new k.DocLinkTag({configuration:this._$$_tsdocConfiguration,tagName:"@link",linkText:"Home",urlDestination:this._$$_getLinkFilenameForApiItem(this._$$_apiModel)}));var r=t.getHierarchy(),n=Array.isArray(r),i=0;for(r=n?r:r[Symbol.iterator]();;){var a;if(n){if(i>=r.length)break;a=r[i++]}else{if((i=r.next()).done)break;a=i.value}var o=a;switch(o.kind){case"Model":case"EntryPoint":break;default:e.appendNodesInParagraph([new k.DocPlainText({configuration:this._$$_tsdocConfiguration,text:" > "}),new k.DocLinkTag({configuration:this._$$_tsdocConfiguration,tagName:"@link",linkText:o.displayName,urlDestination:this._$$_getLinkFilenameForApiItem(o)})])}}},t._$$_writeBetaWarning=function(e){var t=this._$$_tsdocConfiguration;e.appendNode(new ee({configuration:t},[new k.DocParagraph({configuration:t},[new k.DocPlainText({configuration:t,text:"This API is provided as a preview for developers and may change based on feedback that we receive.  Do not use this API in a production environment."})])]))},t._$$_appendSection=function(e,t){var r=t.nodes,n=Array.isArray(r),i=0;for(r=n?r:r[Symbol.iterator]();;){var a;if(n){if(i>=r.length)break;a=r[i++]}else{if((i=r.next()).done)break;a=i.value}e.appendNode(a)}},t._$$_appendAndMergeSection=function(e,t){var r=!0,n=t.nodes,i=Array.isArray(n),a=0;for(n=i?n:n[Symbol.iterator]();;){var o;if(i){if(a>=n.length)break;o=n[a++]}else{if((a=n.next()).done)break;o=a.value}var s=o;r&&s.kind===le.Paragraph?(e.appendNodesInParagraph(s.getChildNodes()),r=!1):(r=!1,e.appendNode(s))}},t._$$_getFilenameForApiItem=function(e){if("Model"===e.kind)return"index.md";var t="",r=e.getHierarchy(),n=Array.isArray(r),i=0;for(r=n?r:r[Symbol.iterator]();;){var a;if(n){if(i>=r.length)break;a=r[i++]}else{if((i=r.next()).done)break;a=i.value}var o=a,s=oe.getSafeFilenameForName(o.displayName);switch(w.ApiParameterListMixin.isBaseClassOf(o)&&o.overloadIndex>1&&(s+="_"+(o.overloadIndex-1)),o.kind){case"Model":case"EntryPoint":break;case"Package":t=oe.getSafeFilenameForName($.PackageName.getUnscopedName(o.displayName));break;default:t+="."+s}}return t+".md"},t._$$_getLinkFilenameForApiItem=function(e){return"./"+this._$$_getFilenameForApiItem(e)},t._$$_deleteOldOutputFiles=function(){console.log("Deleting old output from "+this._$$_outputFolder),$.FileSystem.ensureEmptyFolder(this._$$_outputFolder)},e}(),he=function(e){function t(t,r){var n;return(n=e.call(this,t,r)||this).inputFolder=t,n.outputFolder=r,n}return T(t,e),t.prototype.onExecute=function(e){console.error(this.inputFolder,this.outputFolder);var t=this.buildApiModel();return new me(t,e,void 0).generateFiles(this.outputFolder),Promise.resolve()},t}(Q),ge=require("js-yaml"),_e=$.JsonSchema.fromFile(a.join(__dirname,"..","yaml","typescript.schema.json")),$e=function(){function e(e,t){void 0===t&&(t=!1),this._$$_apiModel=e,this.newDocfxNamespaces=t,this._$$_markdownEmitter=new pe(this._$$_apiModel),this._$$_apiItemsByCanonicalReference=new Map,this._$$_initApiItems()}var t=e.prototype;return t.generateFiles=function(e){this._$$_outputFolder=e,console.log(),this._$$_deleteOldOutputFiles();var t=this._$$_apiModel.packages,r=Array.isArray(t),n=0;for(t=r?t:t[Symbol.iterator]();;){var i;if(r){if(n>=t.length)break;i=t[n++]}else{if((n=t.next()).done)break;i=n.value}var a=i;console.log("Writing "+a.name+" package"),this._$$_visitApiItems(a,void 0)}this._$$_writeTocFile(this._$$_apiModel.packages)},t.onGetTocRoot=function(){return{name:"SharePoint Framework reference",href:"~/overview/sharepoint.md",items:[]}},t.onCustomizeYamlItem=function(e){},t._$$_visitApiItems=function(e,t){var r;this._shouldEmbed(e.kind)||(r=this._$$_yamlReferences,this._$$_yamlReferences=void 0);var n=this._$$_generateYamlItem(e);if(!n)return!1;if(this.onCustomizeYamlItem(n),this._shouldEmbed(e.kind)){if(!t)throw new $.InternalError("Missing file context");t.items.push(n)}else{var i={items:[]};i.items.push(n);var a=this._getLogicalChildren(e),o=Array.isArray(a),s=0;for(a=o?a:a[Symbol.iterator]();;){var c;if(o){if(s>=a.length)break;c=a[s++]}else{if((s=a.next()).done)break;c=s.value}var l=c;l instanceof w.ApiDocumentedItem&&this._$$_visitApiItems(l,i)&&(n.children||(n.children=[]),n.children.push(this._getUid(l)))}this._$$_yamlReferences&&this._$$_yamlReferences.references.length>0&&(i.references=this._$$_yamlReferences.references),this._$$_yamlReferences=r;var d=this._$$_getYamlFilePath(e);"Package"===e.kind&&console.log("Writing "+d),this._$$_writeYamlFile(i,d,"UniversalReference",_e),t&&this._$$_recordYamlReference(this._$$_ensureYamlReferences(),this._getUid(e),this._$$_getYamlItemName(e,{includeNamespace:!this.newDocfxNamespaces,includeSignature:!0}),this._$$_getYamlItemName(e,{includeNamespace:!0,includeSignature:!0}))}return!0},t._getLogicalChildren=function(e){var t=[];return"Package"===e.kind?this._$$_flattenNamespaces(e.members[0].members,t,this.newDocfxNamespaces?0:3):this._$$_flattenNamespaces(e.members,t,this.newDocfxNamespaces?2:3),t},t._$$_flattenNamespaces=function(e,t,r){var n=!1,i=e,a=Array.isArray(i),o=0;for(i=a?i:i[Symbol.iterator]();;){var s;if(a){if(o>=i.length)break;s=i[o++]}else{if((o=i.next()).done)break;s=o.value}var c=s;if("Namespace"===c.kind)switch(r){case 3:this._$$_flattenNamespaces(c.members,t,3);break;case 1:case 0:var l=t.length;t.push(c),this._$$_flattenNamespaces(c.members,t,1)||t.splice(l,1)}else if(this._shouldInclude(c.kind)){switch(r){case 3:case 0:case 2:t.push(c)}n=!0}}return n},t._$$_writeTocFile=function(e){var t=this.buildYamlTocFile(e),r=a.join(this._$$_outputFolder,"toc.yml");console.log("Writing "+r),this._$$_writeYamlFile(t,r,"",void 0)},t.buildYamlTocFile=function(e){var t,r={items:[]},n=this.onGetTocRoot();return r.items.push(n),(t=n.items).push.apply(t,this._$$_buildTocItems(e)),r},t._$$_buildTocItems=function(e){var t=[],r=e,n=Array.isArray(r),i=0;for(r=n?r:r[Symbol.iterator]();;){var a;if(n){if(i>=r.length)break;a=r[i++]}else{if((i=r.next()).done)break;a=i.value}var o=a,s=void 0;if("Namespace"!==o.kind||this.newDocfxNamespaces){if(this._shouldEmbed(o.kind))continue;s={name:this._getTocItemName(o),uid:this._getUid(o)}}else s={name:this._getTocItemName(o)};t.push(s);var c=this._getLogicalChildren(o),l=this._$$_buildTocItems(c);l.length>0&&(s.items=l)}return t},t._getTocItemName=function(e){var t;return(t="Package"===e.kind?$.PackageName.getUnscopedName(e.displayName):this._$$_getYamlItemName(e))===e.displayName&&e.getMergedSiblings().length>1&&(t+=" ("+e.kind+")"),t},t._shouldEmbed=function(e){switch(e){case"Class":case"Package":case"Interface":case"Enum":return!1;case"Namespace":return!this.newDocfxNamespaces}return!0},t._shouldInclude=function(e){switch(e){case"CallSignature":case"ConstructSignature":case"IndexSignature":return!1}return!0},t._$$_generateYamlItem=function(e){if(this._shouldInclude(e.kind)){var t=this._getUidObject(e),r={uid:t.toString()};if(e.tsdocComment){var n=e.tsdocComment;if(n.summarySection){var i=this._$$_renderMarkdown(n.summarySection,e);i&&(r.summary=i)}if(n.remarksBlock){var a=this._$$_renderMarkdown(n.remarksBlock.content,e);a&&(r.remarks=a)}if(n.deprecatedBlock){var o=this._$$_renderMarkdown(n.deprecatedBlock.content,e);o.length>0&&(r.deprecated={content:o})}}switch(w.ApiReleaseTagMixin.isBaseClassOf(e)&&e.releaseTag===w.ReleaseTag.Beta&&(r.isPreview=!0),r.name=this._$$_getYamlItemName(e,{includeSignature:!0,includeNamespace:!this.newDocfxNamespaces}),r.fullName=this._$$_getYamlItemName(e,{includeSignature:!0,includeNamespace:!0}),r.langs=["typeScript"],"Namespace"!==e.kind&&e.parent&&"Namespace"===e.parent.kind&&this.newDocfxNamespaces&&(r.namespace=e.parent.canonicalReference.toString()),e.kind){case"Enum":r.type="enum";break;case"EnumMember":r.type="field",e.initializerExcerpt.text.length>0&&(r.numericValue=e.initializerExcerpt.text);break;case"Class":r.type="class",this._$$_populateYamlClassOrInterface(t,r,e);break;case"Interface":r.type="interface",this._$$_populateYamlClassOrInterface(t,r,e);break;case"Method":case"MethodSignature":r.type="method",this._$$_populateYamlFunctionLike(t,r,e);break;case"Constructor":r.type="constructor",this._$$_populateYamlFunctionLike(t,r,e);break;case"Package":r.type="package";break;case"Namespace":r.type="namespace";break;case"Property":case"PropertySignature":var s=e;r.type=s.isEventProperty?"event":"property",this._$$_populateYamlProperty(t,r,s);break;case"Function":r.type="function",this._$$_populateYamlFunctionLike(t,r,e);break;case"Variable":r.type="variable",this._$$_populateYamlVariable(t,r,e);break;case"TypeAlias":r.type="typealias",this._$$_populateYamlTypeAlias(t,r,e);break;default:throw new Error("Unimplemented item kind: "+e.kind)}if("Package"!==e.kind&&!this._shouldEmbed(e.kind)){var c=e.getAssociatedPackage();if(!c)throw new Error("Unable to determine associated package for "+e.displayName);r.package=this._getUid(c)}return r}},t._$$_populateYamlTypeParameters=function(e,t){var r=[],n=t.typeParameters,i=Array.isArray(n),a=0;for(n=i?n:n[Symbol.iterator]();;){var o;if(i){if(a>=n.length)break;o=n[a++]}else{if((a=n.next()).done)break;o=a.value}var s=o,c={id:s.name};s.tsdocTypeParamBlock&&(c.description=this._$$_renderMarkdown(s.tsdocTypeParamBlock.content,t)),s.constraintExcerpt.isEmpty||(c.type=[this._$$_renderType(e,s.constraintExcerpt)]),r.push(c)}return r},t._$$_populateYamlClassOrInterface=function(e,t,r){if(r instanceof w.ApiClass){if(r.extendsType&&(t.extends=[this._$$_renderType(e,r.extendsType.excerpt)],t.inheritance=this._$$_renderInheritance(e,[r.extendsType])),r.implementsTypes.length>0){t.implements=[];var n=r.implementsTypes,i=Array.isArray(n),a=0;for(n=i?n:n[Symbol.iterator]();;){var o;if(i){if(a>=n.length)break;o=n[a++]}else{if((a=n.next()).done)break;o=a.value}t.implements.push(this._$$_renderType(e,o.excerpt))}}}else if(r instanceof w.ApiInterface){if(r.extendsTypes.length>0){t.extends=[];var s=r.extendsTypes,c=Array.isArray(s),l=0;for(s=c?s:s[Symbol.iterator]();;){var d;if(c){if(l>=s.length)break;d=s[l++]}else{if((l=s.next()).done)break;d=l.value}t.extends.push(this._$$_renderType(e,d.excerpt))}t.inheritance=this._$$_renderInheritance(e,r.extendsTypes)}var u=this._$$_populateYamlTypeParameters(e,r);u.length&&(t.syntax={typeParameters:u})}var p;r.tsdocComment&&r.tsdocComment.modifierTagSet.isSealed()&&(p="Class"===r.kind?"This class is marked as `@sealed`. Subclasses should not extend it.":"This interface is marked as `@sealed`. Other interfaces should not extend it.",t.remarks=t.remarks?p+"\n\n"+t.remarks:p)},t._$$_populateYamlFunctionLike=function(e,t,r){var n={content:r.getExcerptWithModifiers()};if(t.syntax=n,w.ApiReturnTypeMixin.isBaseClassOf(r)){var i=this._$$_renderType(e,r.returnTypeExcerpt),a="";r.tsdocComment&&r.tsdocComment.returnsBlock&&(a=(a=this._$$_renderMarkdown(r.tsdocComment.returnsBlock.content,r)).replace(/^\s*-\s+/,"")),(i||a)&&(n.return={type:[i],description:a})}var o=[],s=r.parameters,c=Array.isArray(s),l=0;for(s=c?s:s[Symbol.iterator]();;){var d;if(c){if(l>=s.length)break;d=s[l++]}else{if((l=s.next()).done)break;d=l.value}var u=d,p="";u.tsdocParamBlock&&(p=this._$$_renderMarkdown(u.tsdocParamBlock.content,r)),o.push({id:u.name,description:p,type:[this._$$_renderType(e,u.parameterTypeExcerpt)]})}if(o.length&&(n.parameters=o),w.ApiTypeParameterListMixin.isBaseClassOf(r)){var f=this._$$_populateYamlTypeParameters(e,r);f.length&&(n.typeParameters=f)}},t._$$_populateYamlProperty=function(e,t,r){var n={content:r.getExcerptWithModifiers()};t.syntax=n,r.propertyTypeExcerpt.text&&(n.return={type:[this._$$_renderType(e,r.propertyTypeExcerpt)]})},t._$$_populateYamlVariable=function(e,t,r){var n={content:r.getExcerptWithModifiers()};t.syntax=n,r.variableTypeExcerpt.text&&(n.return={type:[this._$$_renderType(e,r.variableTypeExcerpt)]})},t._$$_populateYamlTypeAlias=function(e,t,r){var n={content:r.getExcerptWithModifiers()};t.syntax=n;var i=this._$$_populateYamlTypeParameters(e,r);i.length&&(n.typeParameters=i),r.typeExcerpt.text&&(n.return={type:[this._$$_renderType(e,r.typeExcerpt)]})},t._$$_renderMarkdown=function(e,t){var r=this,n=new k.StringBuilder;return this._$$_markdownEmitter.emit(n,e,{contextApiItem:t,onGetFilenameForApiItem:function(e){return encodeURI("xref:"+r._getUid(e)).replace(/[#?]/g,(function(e){return encodeURIComponent(e)})).replace(/(\([^(]*\))|[()]/g,(function(e,t){return t||"\\"+e}))}}),n.toString().trim()},t._$$_writeYamlFile=function(e,t,r,n){$.JsonFile.validateNoUndefinedMembers(e);var i=ge.safeDump(e,{lineWidth:120});r&&(i="### YamlMime:"+r+"\n"+i),$.FileSystem.writeFile(t,i,{convertLineEndings:"\r\n",ensureFolderExists:!0}),n&&n.validateObject(e,t)},t._getUid=function(e){return this._getUidObject(e).toString()},t._getUidObject=function(e){return e.canonicalReference},t._$$_initApiItems=function(){this._$$_initApiItemsRecursive(this._$$_apiModel)},t._$$_initApiItemsRecursive=function(e){if(e.canonicalReference&&!e.canonicalReference.isEmpty&&this._$$_apiItemsByCanonicalReference.set(e.canonicalReference.toString(),e),w.ApiItemContainerMixin.isBaseClassOf(e)){var t=e.members,r=Array.isArray(t),n=0;for(t=r?t:t[Symbol.iterator]();;){var i;if(r){if(n>=t.length)break;i=t[n++]}else{if((n=t.next()).done)break;i=n.value}this._$$_initApiItemsRecursive(i)}}},t._$$_ensureYamlReferences=function(){return this._$$_yamlReferences||(this._$$_yamlReferences={references:[],typeNameToUid:new Map,uidTypeReferenceCounters:new Map}),this._$$_yamlReferences},t._$$_renderInheritance=function(e,t){var r=[],n=t,i=Array.isArray(n),a=0;for(n=i?n:n[Symbol.iterator]();;){var o;if(i){if(a>=n.length)break;o=n[a++]}else{if((a=n.next()).done)break;o=a.value}var s=this._$$_renderType(e,o.excerpt),c={type:s},l=this._$$_apiItemsByCanonicalReference.get(s);l&&(l instanceof w.ApiClass?l.extendsType&&(c.inheritance=this._$$_renderInheritance(this._getUidObject(l),[l.extendsType])):l instanceof w.ApiInterface&&l.extendsTypes.length>0&&(c.inheritance=this._$$_renderInheritance(this._getUidObject(l),l.extendsTypes))),r.push(c)}return r},t._$$_renderType=function(e,t){var r=t.tokens.slice(t.tokenRange.startIndex,t.tokenRange.endIndex);if(0===r.length)return"";var n=r[r.length-1];if("Content"===n.kind&&!n.text.trim()&&(r.pop(),0===r.length))return"";var i=t.text.trim();if(!r.some((function(e){return"Reference"===e.kind&&!!e.canonicalReference})))return i;var a=this._$$_ensureYamlReferences(),o=a.typeNameToUid.get(i);if(o)return o;if(1===r.length&&"Reference"===r[0].kind&&r[0].canonicalReference){var s=r[0].canonicalReference.toString(),c=this._$$_apiItemsByCanonicalReference.get(s);return this._$$_recordYamlReference(a,r[0].canonicalReference.toString(),c?this._$$_getYamlItemName(c):i,c?this._$$_getYamlItemName(c,{includeNamespace:!0}):i)}var l=e.withMeaning(void 0).withOverloadIndex(void 0).toString(),d=a.uidTypeReferenceCounters.get(l)||0;a.uidTypeReferenceCounters.set(l,d+1);var u=e.addNavigationStep("~",""+d).withMeaning("complex").withOverloadIndex(void 0).toString();return this._$$_recordYamlReference(a,u,i,i,r)},t._$$_recordYamlReference=function(e,t,r,n,i){if(e.references.some((function(e){return e.uid===t})))return t;var a=[];if(i){var o=i,s=Array.isArray(o),c=0;for(o=s?o:o[Symbol.iterator]();;){var l;if(s){if(c>=o.length)break;l=o[c++]}else{if((c=o.next()).done)break;l=c.value}var d=l;if("Reference"===d.kind){var u={},p=d.canonicalReference&&d.canonicalReference.toString(),f=p?this._$$_apiItemsByCanonicalReference.get(p):void 0;p&&(u.uid=p),u.name=d.text,u.fullName=f?f.getScopedNameWithinPackage():d.canonicalReference?d.canonicalReference.withSource(void 0).withMeaning(void 0).withOverloadIndex(void 0).toString():d.text,a.push(u)}else a.push({name:d.text,fullName:d.text})}}var m={uid:t};return a.length>0?(m.name=a.map((function(e){return e.name})).join("").trim(),m.fullName=a.map((function(e){return e.fullName||e.name})).join("").trim(),m["spec.typeScript"]=a):(r!==t&&(m.name=r),n!==t&&n!==r&&(m.fullName=n)),e.references.push(m),t},t._$$_getYamlItemName=function(e,t){void 0===t&&(t={});var r=t.includeNamespace,n=t.includeSignature?oe.getConciseSignature(e):e.displayName;if((r||"Namespace"===e.kind)&&e.parent&&"Namespace"===e.parent.kind){for(var i=[n],a=e.parent;a&&"Namespace"===a.kind;a=a.parent)i.unshift(a.displayName);return i.join(".")}return n},t._$$_getYamlFilePath=function(e){var t="",r=e.getHierarchy(),n=Array.isArray(r),i=0;for(r=n?r:r[Symbol.iterator]();;){var o;if(n){if(i>=r.length)break;o=r[i++]}else{if((i=r.next()).done)break;o=i.value}var s=o;switch(s.kind){case"Model":case"EntryPoint":break;case"Package":t+=oe.getSafeFilenameForName($.PackageName.getUnscopedName(s.displayName));break;default:t+=s.parent&&"EntryPoint"===s.parent.kind?"/":".",t+=oe.getSafeFilenameForName(s.displayName)}}var c="";return e.getMergedSiblings().length>1&&(c="-"+e.kind.toLowerCase()),a.join(this._$$_outputFolder,t+c+".yml")},t._$$_deleteOldOutputFiles=function(){console.log("Deleting old output from "+this._$$_outputFolder),$.FileSystem.ensureEmptyFolder(this._$$_outputFolder)},e}(),we=function(e){function t(){return e.apply(this,arguments)||this}T(t,e);var r=t.prototype;return r.onDefineParameters=function(){e.prototype.onDefineParameters.call(this)},r.onExecute=function(){console.error(this.inputFolder,this.outputFolder);var e=this.buildApiModel();return new $e(e,void 0).generateFiles(this.outputFolder),Promise.resolve()},t}(Q);exports.MarkdownAction=he,exports.MarkdownDocumenterAccessor=v,exports.MarkdownDocumenterFeature=A,exports.MarkdownDocumenterFeatureContext=N,exports.PluginFeature=S,exports.PluginFeatureContext=function(){},exports.PluginFeatureInitialization=C,exports.YamlAction=we,exports.init=function(){var e=z(),t=function(){if(0===U.length)return z();var e=U.map(G);return r.parallel(e)}(),n=J.createApiTask(),a=J.createApiFixedTask({items:[{name:D}]});i.task("api:main",e),i.task("api:all",t),i.task("api:fix",n),i.task("doc:fix",a);var o=i.task("build",(function(){r.src(".",{read:!1}).pipe(i.logger("Exec")("api-documenter markdown -i "+R("./etc")+" -o "+R("./document/articles"))).pipe(i.logger("Exec")("api-documenter yaml -i "+R("./etc")+" -o "+R("./document/src"))).pipe(i.logger("Exec")("docfx build "+R("./document/docfx.json"))).pipe(i.shell("docfx build "+R("./document/docfx.json"))).pipe(i.logger("Run server with:")(_.cyan(_.underline("docfx serve ./docs"))))})),s=i.task("doc:templateTmp",(function(){return r.src(F("./config/document/**")).pipe(p('"../docs"','"'+F("./docs",!0)+'"')).pipe(r.dest(R("./document")))})),c=i.task("clean:doctmp",i.shellTask("rimraf "+R("./document/**")));i.task("doc:template",(function(){return r.src(F("./config/document/**")).pipe(r.dest("./document"))})),r.task("default",r.series(t,n,c,s,r.parallel(i.task("markdown:articles",(function(){try{var e=new he(R("./etc"),R("./document/articles"));return Promise.resolve(e.onExecute(F(".",!0)))}catch(e){return Promise.reject(e)}})),i.task("ymlfile:src",(function(){try{var e=new we(R("./etc"),R("./document/src"));return Promise.resolve(e.onExecute())}catch(e){return Promise.reject(e)}}))),a,o))};
//# sourceMappingURL=ts-api-docs.cjs.production.min.js.map
